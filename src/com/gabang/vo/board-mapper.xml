<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gabang.vo.board-mapper">
	<!-- 게시물 -->
	<select id="boardListData" resultType="BoardVO" parameterType="java.util.Map">
		SELECT no,title,email,regdate,hit,num
		FROM (SELECT
		no,title,email,regdate,hit,rownum as num
		FROM (SELECT
		no,title,email,regdate,hit
		FROM qna ORDER BY no DESC))
		WHERE num BETWEEN
		#{start} AND #{end}
	</select>

	<!-- 총페이지 읽기 -->
	<select id="boardTotalPage" resultType="int">
		SELECT CEIL(COUNT(*)/10)
		FROM qna
	</select>
	<!-- 새 게시물넣기 -->
	<insert id="boardInsert" parameterType="BoardVO">
		INSERT INTO
		qna(no,email,title,content,hit) VALUES(
		(SELECT NVL(MAX(no)+1,1) FROM
		qna),
		#{email},#{title},#{content},0
		)
	</insert>



	<!-- content 상세보기 -->
	<sql id="where-no">
		WHERE no = #{no}
	</sql>
	<!-- 조회수증가 -->
	<update id="hitIncrement">
		UPDATE qna SET
		hit = hit+1
		<include refid="where-no" />
	</update>

	<!-- 상세보기 -->
	<select id="boardContentData" resultType="BoardVO"
		parameterType="int">
		SELECT no, title, content, email, regdate, hit
		FROM qna
		<include refid="where-no" />
	</select>

	<!-- 업데이트 -->
	<update id="boardUpdate" parameterType="BoardVO">
		UPDATE qna SET
		title=#{title}, content=#{content}
		WHERE no = #{no}
	</update>

	<!-- 삭제 -->
	<delete id="boardDelete" parameterType="int">
		DELETE FROM qna
		<include refid="where-no" />
	</delete>

</mapper>


